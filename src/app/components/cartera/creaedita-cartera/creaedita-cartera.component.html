<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registrar Cartera</title>
</head>
<body>
  <div class="content-container">
    <div class="form-container">
      <h5>{{ edicion ? 'Editar Cartera' : 'Nueva Cartera' }}</h5>
    
      <form [formGroup]="form" class="cartera-form-container" (ngSubmit)="registrar()">
        <div class="form-row">

          <!-- Nombre -->
          <mat-form-field appearance="outline" class="form-column">
            <mat-label>Nombre</mat-label>
            <input matInput formControlName="nombre" placeholder="Ingrese nombre de la cartera" />
            <mat-error *ngIf="form.get('nombre')?.hasError('required') && form.get('nombre')?.touched">
              El nombre de la cartera es obligatorio.
            </mat-error>
          </mat-form-field>

          <!-- Fecha de Descuento -->
          <mat-form-field appearance="outline" class="form-column">
            <mat-label>Fecha de Descuento</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="fechaDescuento" />
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="form.get('fechaDescuento')?.hasError('required')">
              La fecha de descuento es obligatoria.
            </mat-error>
            <mat-error *ngIf="form.get('fechaDescuento')?.hasError('fechaDescuentoInvalida')">
              La fecha de descuento no puede ser anterior a la fecha actual.
            </mat-error>
          </mat-form-field>

        </div>

        <div class="form-row">
          <!-- Empresa -->
          <mat-form-field appearance="outline" class="form-column">
            <mat-label>Empresa</mat-label>
            <mat-select formControlName="empresa">
              <mat-option *ngFor="let empresa of listaEmpresas" [value]="empresa.idEmpresa">
                {{ empresa.nombre }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('empresa')?.hasError('required') && form.get('empresa')?.touched">
              La empresa es obligatoria.
            </mat-error>
          </mat-form-field>

          <!-- Moneda -->
          <mat-form-field appearance="outline" class="form-column">
            <mat-label>Moneda</mat-label>
            <mat-select formControlName="moneda">
              <mat-option *ngFor="let moneda of monedas" [value]="moneda.value">
                {{ moneda.viewValue }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="form.get('moneda')?.hasError('required') && form.get('moneda')?.touched">
              La moneda es obligatoria.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="button-container">
          <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">
            {{ edicion ? 'Actualizar' : 'Registrar' }}
          </button>
          <button mat-button color="warn" type="button" routerLink="/cartera/listar_cartera_usuario">
            Cancelar
          </button>
        </div>
      </form>
    </div> 
  </div>
</body>
</html>
